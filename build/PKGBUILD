# This is an example PKGBUILD file. Use this as a start to creating your own,
# and remove these comments. For more information, see 'man PKGBUILD'.
# NOTE: Please fill out the license field for your package! If it is unknown,
# then please put 'unknown'.

# Maintainer: Your Name <devel@lasath.org>
pkgname=pr-notify
pkgver=1.0
pkgrel=1
pkgdesc="My Kargos script to check for PRs in Azure Devops"
arch=('any')
url="https://github.com/shocklateboy92/pr-notify"
license=('MIT')
groups=('kargos')
depends=('nodejs')
makedepends=('yarn')
checkdepends=()
optdepends=()
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=
changelog=
source=()
noextract=()
md5sums=()
validpgpkeys=()

build() {
    yarn;
	yarn build --mode=production;
}

package() {
    destdir="${pkgdir}/usr/local";
    cd ../../;

    lib_dir="${destdir}/lib/js";
    mkdir -p "$lib_dir";
    cp "./dist/main.js" "$lib_dir/pr-notify.js";

    icon_dir="$destdir/share/icons";
    mkdir -p "$icon_dir";
    cp git-pull-request-icon.svg "$icon_dir";

    cp ./src/kargos-script.pr-notify.300s.sh "$destdir/bin/";
}

